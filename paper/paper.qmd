---
title: "Project EDS-214"
author: "Hylaea Miller"
format: html
editor: visual

execute:
  warning: false
  message: false
---

## Background

This project is part of the course Environmental Data Science Analytical Workflows and Scientific Reproducibility, that aims to recreate **Figure 3.** from Schaefer et al.[(2000)](https://doi.org/10.1017/s0266467400001358) study. This time-series plot shows a 9-week moving average of stream water concentrations before and after the 1989 Hurricane Hugo disturbance, based on long-term stream water quality observations in the Luquillo Mountains, Puerto Rico.

![**Figure 3**](images/clipboard-318770943.png){width="430"}

### Packages used on the project and function

```{r}

library(tidyverse)
library(janitor)
library(lubridate)
library(patchwork)
library(here)
library(paletteer)

source(here("R/Function.R"))
```

## Data

The data are available through the Environmental Data Initiative. You can find them here: [(McDowell and International Institute Of Tropical Forestry (IITF) 2024)](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-luq.20.4923064)

-   Quebrada one-Bisley (Q1) Chemistry Data
-   Quebrada two-Bisley (Q2) Chemistry Data
-   Quebrada three-Bisley (Q3) Chemistry Data
-   Puente Roto Mameyes (MPR) Chemistry Data

## Methods

The data was imported from the Environmental Data Initiative and arranged for the creation of the figure 3 of the article (*"[Effects of hurricane disturbance on stream water concentrations and fluxes in eight tropical forest watersheds of the Luquillo Experimental Forest, Puerto Rico](https://www.cambridge.org/core/journals/journal-of-tropical-ecology/article/abs/effects-of-hurricane-disturbance-on-stream-water-concentrations-and-fluxes-in-eight-tropical-forest-watersheds-of-the-luquillo-experimental-forest-puerto-rico/2511D4A53DA2C95406014ED75441E77B)"*.) A 9-week moving average was calculated for the concentration of the following nutrients: (a) potassium, (b) nitrate-N, (c) magnesium, (d) calcium, and (e) ammonia-N. The graph was created with ggplot2, and the results were compared with the original figure.

You can see the workflow steps below:

![**Workflow**](images/Data-01.png){width="Infinity" fig-align="center"}

### Tidying data

```{r}

bq1 <- readRDS(here("output", "RDS", "bq1.rds"))
bq2 <- readRDS(here("output", "RDS", "bq2.rds"))
bq3 <- readRDS(here("output", "RDS", "bq3.rds"))
prm <- readRDS(here("output", "RDS", "prm.rds"))
```

### Creating a data frame with the water concentration of each nutrient

```{r}

df_ca <- readRDS(here("output", "RDS", "df_ca.rds"))
df_k  <- readRDS(here("output", "RDS", "df_k.rds"))
df_mg <- readRDS(here("output", "RDS", "df_mg.rds"))
df_nh4 <- readRDS(here("output", "RDS", "df_nh4.rds"))
df_no3 <- readRDS(here("output", "RDS", "df_no3.rds"))
```

## Results

### Plotting data

```{r}

plot_k <- readRDS(here("output", "RDS", "plot_k.rds"))

plot_mg <- readRDS(here("output", "RDS", "plot_mg.rds"))

plot_ca <- readRDS(here("output", "RDS", "plot_ca.rds"))

plot_no3 <- readRDS(here("output", "RDS", "plot_no3.rds"))

plot_nh4 <- readRDS(here("output", "RDS", "plot_nh4.rds"))


combined_figure <- readRDS(here("output", "RDS", "combined_figure.rds"))

```

![](images/combined_figure.jpg){width="634"}

## Acknowledgements

Schaefer DouglasA, McDowell WH, Scatena FN, Asbury CE. Effects of hurricane disturbance on stream water concentrations and fluxes in eight tropical forest watersheds of the Luquillo Experimental Forest, Puerto Rico. *Journal of Tropical Ecology*. 2000;16(2):189-207. <doi:10.1017/S0266467400001358>
